{% extends "base.html" %}
{% block title %} Викторина {% endblock %}
{% block header %} {{ quiz.title }} {% endblock %}
{% block content %}
  {% if question is None %}
    <div class='row'><h2>Нет вопросов</h2></div>
    <a href="{% url 'index' %}"  class="btn btn-info mb-3 mt-1 shadow-sm" type="button">Вернутья на главную</a>
  {% else %}
    <div class="container">
      <h2>
        <input type="text" readonly class="form-control-plaintext" id="question_text" value="Вопрос: {{ question.content|linebreaksbr }}">
      </h2>
      {% if question.image != "" %}
        {% load thumbnail %}
        {% thumbnail question.image "560x400" crop="center" upscale=False as im %}
        <img src="{{ im.url }}" alt="" class="mb-3 mt-1 shadow-sm">
        {% endthumbnail %}
      {% endif %}

      <form method="post" action="{% url 'play' quiz.slug %}" enctype="multipart/form-data">
        {% csrf_token %}
        {% if result is None %}
            {% if question.type == 'choise' %}
              <ul class="mx-auto">
                {% for answer in answers %}
                    <div class="form-check sm-3 row">
                      <h3>
                        <label class="form-check-label" for="flexCheckDefault">
                          <input class="form-check-input xl" type="checkbox" value="on" id="flexCheckDefault" name="answer-{{ answer.pk }}"/>
                            {{ answer.content }}
                        </label>
                      </h3>
                    </div>
                {% endfor %}
              </ul>
            {% elif question.type == 'input' %}
              <input class="form-control mb-3 mt-1 shadow-sm" type="text" id="sample3" name="user_input" placeholder="Ваш ответ">
            {% endif %}
          <button class="btn btn-success mb-3 mt-1 shadow-sm" type="submit">
            Проверить
          </button>
        {% else %}
          <div>
            {% if result %}
              <h3></h3>
              <span class="badge bg-success">Правильный ответ</span>
            {% else %}
            <span class="badge bg-danger">Неправильный ответ</span>
              <h3></h3>
            {% endif %}
            <p>Правильно: {{ correct_answers }}</p>
            <p>Ваш ответ: {{ user_answers }}</p>
          </div>
          {% if question_index < quiz.questions.count %}
            <button class="btn btn-primary mb-3 mt-1 shadow-sm" type="submit">
              Следующий вопрос
            </button>
          {% else %}
            <a href="{% url 'success_page' quiz.slug %}" class="btn btn-info mb-3 mt-1 shadow-sm" type="button">
              Перейти к результатам
            </a>
          {% endif %}
        {% endif %}
      </form>
      <div class="progress">
        <div class="progress-bar bg-info progress-bar-striped progress-bar-animated" role="progressbar" style="width: {{ progress }}%">{{ progress }}%</div>
      </div>
    </div>
  {% endif %}
{% endblock %}
